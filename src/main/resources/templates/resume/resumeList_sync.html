<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>경력 관리 시스템 - 목록</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Pretendard', sans-serif;
    }

    .dashboard-container {
      max-width: 1000px;
      margin: 50px auto;
    }

    /* 헤더 섹션 */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #212529;
    }

    /* 리스트 카드 스타일 */
    .resume-list-card {
      background: white;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
      border: none;
    }

    /* 테이블 커스텀 */
    .table {
      margin-bottom: 0;
      vertical-align: middle;
    }

    .table thead th {
      border-top: none;
      color: #adb5bd;
      font-weight: 500;
      font-size: 0.85rem;
      padding: 15px;
    }

    .table tbody td {
      padding: 20px 15px;
      border-bottom: 1px solid #f1f3f5;
    }

    .table tbody tr:last-child td {
      border-bottom: none;
    }

    .resume-title {
      font-weight: 600;
      color: #212529;
      text-decoration: none;
    }

    .resume-title:hover {
      color: #0d6efd;
    }

    .author-badge {
      background-color: #f1f3f5;
      color: #495057;
      padding: 5px 12px;
      border-radius: 8px;
      font-size: 0.85rem;
    }

    .date-text {
      color: #adb5bd;
      font-size: 0.85rem;
    }

    /* 작업 버튼 스타일 */
    .btn-action {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: 1px solid #f1f3f5;
      background: white;
      transition: 0.2s;
      color: #6c757d;
    }

    .btn-edit:hover {
      background-color: #e7f1ff;
      color: #0d6efd;
      border-color: #0d6efd;
    }

    .btn-delete:hover {
      background-color: #fff5f5;
      color: #dc3545;
      border-color: #dc3545;
    }

    /* 새 이력서 작성 버튼 */
    .btn-create {
      background-color: #212529;
      color: white;
      border-radius: 12px;
      padding: 10px 20px;
      font-weight: 600;
      text-decoration: none;
      transition: 0.2s;
    }

    .btn-create:hover {
      background-color: #000;
      color: white;
      transform: translateY(-2px);
    }
  </style>
</head>
<div layout:fragment="content">
  <body>
  <div class="content-body">
    <div class="container-fluid">

      <div class="container dashboard-container">
        <div class="page-header">
          <div class="page-title"><i class="bi bi-file-earmark-person me-2"></i>이력서 목록</div>
          <a href="#" class="btn-create" id="btnCreate"><i class="bi bi-plus-lg me-1"></i> 새 이력서 작성</a>
        </div>

        <div class="card resume-list-card">

          <form action="/resume/resumeList_sync" method="GET" class="search-section">
            <div class="row g-2 justify-content-end">
              <div class="col-md-2">
                <select class="form-select search-select" name="searchType">
                  <optgroup label="1.개인정보">
                    <option value="name" th:selected="${searchType == 'name'}">이름</option>
                    <option value="gender" th:selected="${searchType == 'gender'}">성별</option>
                    <option value="birth" th:selected="${searchType == 'birth'}">생년월일</option>
                    <option value="role" th:selected="${searchType == 'role'}">직위</option>
                    <option value="military" th:selected="${searchType == 'military'}">병역</option>
                    <option value="marriage" th:selected="${searchType == 'marriage'}">결혼</option>
                    <option value="landlineNumber" th:selected="${searchType == 'landlineNumber'}">전화번호(유선)</option>
                    <option value="phoneNumber" th:selected="${searchType == 'phoneNumber'}">전화번호(무선)</option>
                    <option value="email" th:selected="${searchType == 'email'}">이메일</option>
                    <option value="address" th:selected="${searchType == 'address'}">주소</option>
                  </optgroup>
                  <optgroup label="2.학력사항">
                    <option value="schoolName" th:selected="${searchType == 'schoolName'}">학교명</option>
                    <option value="schoolStatus" th:selected="${searchType == 'schoolStatus'}">졸업여부</option>
                    <option value="schoolDate" th:selected="${searchType == 'schoolDate'}">졸업일자</option>
                  </optgroup>
                  <optgroup label="3.경력사항">
                    <option value="CompanyName" th:selected="${searchType == 'CompanyName'}">회사명</option>
                    <option value="CompanyRole" th:selected="${searchType == 'CompanyRole'}">직위</option>
                    <option value="CompanyWork" th:selected="${searchType == 'CompanyWork'}">담당업무</option>
                    <option value="CompanyStartTerm" th:selected="${searchType == 'CompanyStartTerm'}">시작일자</option>
                    <option value="CompanyEndTerm" th:selected="${searchType == 'CompanyEndTerm'}">종료일자</option>
                  </optgroup>
                  <optgroup label="4.자격증">
                    <option value="licenseName" th:selected="${searchType == 'licenseName'}">자격증명</option>
                    <option value="licenseIssuer" th:selected="${searchType == 'licenseIssuer'}">발급기관</option>
                    <option value="licenseDate" th:selected="${searchType == 'licenseDate'}">취득일자</option>
                  </optgroup>
                  <optgroup label="5.기술경력">
                    <option value="projectName" th:selected="${searchType == 'projectName'}">프로젝트명</option>
                    <option value="projectCustomer" th:selected="${searchType == 'projectCustomer'}">고객사</option>
                    <option value="projectCompany" th:selected="${searchType == 'projectCompany'}">근무회사</option>
                    <option value="projectWork" th:selected="${searchType == 'projectWork'}">역할</option>
                    <option value="projectLanguage" th:selected="${searchType == 'projectLanguage'}">언어</option>
                    <option value="projectDb" th:selected="${searchType == 'projectDb'}">DB</option>
                    <option value="projectTool" th:selected="${searchType == 'projectTool'}">Tool</option>
                    <option value="projectFramework" th:selected="${searchType == 'projectFramework'}">Framework</option>
                    <option value="projectStartTerm" th:selected="${searchType == 'projectStartTerm'}">시작일자</option>
                    <option value="projectEndTerm" th:selected="${searchType == 'projectEndTerm'}">종료일자</option>
                    <option value="projectEtc" th:selected="${searchType == 'projectEtc'}">기타</option>
                    <option value="projectWorkDetail" th:selected="${searchType == 'projectWorkDetail'}">상세업무내용</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-4">
                <div class="input-group">
                  <input type="text" name="keyword" class="form-control search-input" placeholder="검색어를 입력하세요..." th:value="${keyword}">
                  <button class="btn btn-dark btn-search" type="submit">
                    <i class="bi bi-search me-1"></i> 검색
                  </button>
                </div>
              </div>
            </div>
          </form>

          <div class="table-responsive">
            <table class="table">
              <thead>
              <tr>
                <th style="width: 45%;">이력서 제목</th>
                <th style="width: 15%;">작성자</th>
                <th style="width: 20%;">작성일</th>
                <th style="width: 20%;">최종 수정일</th>
                <th style="width: 20%; text-align: center;">관리</th>
              </tr>
              </thead>
              <tbody id="resumeTableBody">

              <tr th:if="${#lists.isEmpty(resumeList)}">
                <td colspan="5" class="text-center py-5 text-muted">검색 결과가 없습니다.</td>
              </tr>

              <tr th:each="resume : ${resumeList}">
                <td><a href="#" class="resume-title" th:text="${resume.title}" th:data-id="${resume.resumeId}" onClick="detailResume(this)"></a></td>
                <td><span class="author-badge" th:text="${resume.createdUser}"></span></td>
                <td><span class="date-text" th:text="${resume.createdTime}"></span></td>
                <td><span class="date-text" th:text="${resume.updatedTime}"></span></td>
                <td class="text-center">
                  <button class="btn-action btn-edit me-1" th:data-id="${resume.resumeId}" onclick="editResume(this)" title="수정">
                    <i class="bi bi-pencil-square"></i>
                  </button>
                  <button class="btn-action btn-delete" th:data-id="${resume.resumeId}" onClick="deleteResume(this)" title="삭제">
                    <i class="bi bi-trash3"></i>
                  </button>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 수정 함수
    function editResume(element) {
      // 클릭된 요소(this)의 data-id 값을 가져옴
      const id = $(element).data('id');
      location.href = '/resume/modifyResume?id=' + id;
    }

    function detailResume(element) {
      // 클릭된 요소(this)의 data-id 값을 가져옴
      const id = $(element).data('id');
      location.href = '/resume/resumeDetail?id=' + id;
    }
  </script>

  </body>
</div>
</html>